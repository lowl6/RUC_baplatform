# BAplatform ç³»ç»Ÿæ¶æ„æ¼”è¿›

## ğŸ“Š ç³»ç»Ÿæ¼”è¿›å¯¹æ¯”

### Before (åŸå§‹ç³»ç»Ÿ)

```
BAplatform åŸå§‹æ¶æ„
â”œâ”€â”€ ç”¨æˆ·ç³»ç»Ÿ
â”‚   â”œâ”€â”€ User (åŸºç¡€ç”¨æˆ·)
â”‚   â”œâ”€â”€ StudentInfo (å­¦ç”Ÿä¿¡æ¯)
â”‚   â”œâ”€â”€ TeacherInfo (æ•™å¸ˆä¿¡æ¯)
â”‚   â””â”€â”€ TeacherDisabled (ç¦ç”¨è®°å½•)
â”‚
â”œâ”€â”€ è¯¾ç¨‹ç³»ç»Ÿ
â”‚   â”œâ”€â”€ Course (è¯¾ç¨‹)
â”‚   â”œâ”€â”€ StudentCourse (é€‰è¯¾å…³ç³»)
â”‚   â”œâ”€â”€ CourseFiles (è¯¾ä»¶)
â”‚   â””â”€â”€ CourseComment (è¯¾ç¨‹è®¨è®º)
â”‚
â”œâ”€â”€ ä»»åŠ¡ç³»ç»Ÿ
â”‚   â”œâ”€â”€ Assignment (ä½œä¸š)
â”‚   â”œâ”€â”€ AssignmentFile (ä½œä¸šæ–‡æ¡£)
â”‚   â”œâ”€â”€ AssignmentSubmit (å­¦ç”Ÿæäº¤)
â”‚   â”œâ”€â”€ AssignmentComment (ä½œä¸šè¯„ä»·)
â”‚   â””â”€â”€ Group/GroupMember (å°ç»„)
â”‚
â””â”€â”€ å…¶ä»–
    â””â”€â”€ Announce (é€šçŸ¥)
```

**æ•°æ®æ¨¡å‹**: 11 ä¸ª
**åŠŸèƒ½æ¨¡å—**: 5 ä¸ª
**å…³é”®ç¼ºé™·**: ç¼ºå°‘éç»“æ„åŒ–è®¨è®ºç©ºé—´

---

### After (æ·»åŠ è®ºå›ç³»ç»Ÿå)

```
BAplatform å¢å¼ºæ¶æ„
â”œâ”€â”€ ç”¨æˆ·ç³»ç»Ÿ
â”‚   â”œâ”€â”€ User (åŸºç¡€ç”¨æˆ·)
â”‚   â”œâ”€â”€ StudentInfo (å­¦ç”Ÿä¿¡æ¯)
â”‚   â”œâ”€â”€ TeacherInfo (æ•™å¸ˆä¿¡æ¯)
â”‚   â””â”€â”€ TeacherDisabled (ç¦ç”¨è®°å½•)
â”‚
â”œâ”€â”€ è¯¾ç¨‹ç³»ç»Ÿ
â”‚   â”œâ”€â”€ Course (è¯¾ç¨‹)
â”‚   â”œâ”€â”€ StudentCourse (é€‰è¯¾å…³ç³»)
â”‚   â”œâ”€â”€ CourseFiles (è¯¾ä»¶)
â”‚   â””â”€â”€ CourseComment (è¯¾ç¨‹è®¨è®º)
â”‚
â”œâ”€â”€ ä»»åŠ¡ç³»ç»Ÿ
â”‚   â”œâ”€â”€ Assignment (ä½œä¸š)
â”‚   â”œâ”€â”€ AssignmentFile (ä½œä¸šæ–‡æ¡£)
â”‚   â”œâ”€â”€ AssignmentSubmit (å­¦ç”Ÿæäº¤)
â”‚   â”œâ”€â”€ AssignmentComment (ä½œä¸šè¯„ä»·)
â”‚   â””â”€â”€ Group/GroupMember (å°ç»„)
â”‚
â”œâ”€â”€ ğŸ†• è®ºå›ç³»ç»Ÿ â­
â”‚   â”œâ”€â”€ ContentCategory (å†…å®¹åˆ†ç±»)
â”‚   â”œâ”€â”€ Post (ä¸»è´´) + æ–¹æ³•
â”‚   â”œâ”€â”€ PostLike (ç‚¹èµè®°å½•)
â”‚   â”œâ”€â”€ PostCollect (æ”¶è—è®°å½•)
â”‚   â””â”€â”€ PostComment (è¯„è®ºæ ‘) + æ–¹æ³•
â”‚
â””â”€â”€ å…¶ä»–
    â””â”€â”€ Announce (é€šçŸ¥)
```

**æ•°æ®æ¨¡å‹**: 16 ä¸ª (+5)
**åŠŸèƒ½æ¨¡å—**: 6 ä¸ª (+1)
**æ–°å¢åŠŸèƒ½**: 10 ä¸ª

---

## ğŸ”„ æ•°æ®æ¨¡å‹å…³ç³»æ¼”è¿›

### åŸå§‹è¯¾ç¨‹äº¤äº’æµ

```
User
  â†“
StudentInfo â”€â”€â†’ StudentCourse â”€â”€â†’ Course â†â”€â”€ TeacherInfo
  â†“
AssignmentSubmit â”€â”€â†’ Assignment â”€â”€â†’ CourseComment
                        â†“
                    AssignmentFile
```

### å¢å¼ºåçš„è¯¾ç¨‹äº¤äº’æµ

```
User
  â”œâ†’ StudentInfo â”€â”€â†’ StudentCourse â”€â”€â†’ Course â†â”€â”€ TeacherInfo
  â”‚                                     â”‚
  â”‚   ğŸ†• Post â”€â”€â†’ PostComment         â”‚
  â”‚     â”œâ†’ PostLike                     â”‚
  â”‚     â”œâ†’ PostCollect                  â”‚
  â”‚     â””â†’ ContentCategory              â”‚
  â”‚                                     â”‚
  â”œâ†’ AssignmentSubmit â”€â”€â†’ Assignment â”€â”€â”¤
  â”‚                          â†“         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AssignmentFile
```

---

## ğŸ“ˆ åŠŸèƒ½æ‰©å±•å¯¹æ¯”

| åŠŸèƒ½ç»´åº¦ | åŸå§‹ç³»ç»Ÿ | å¢å¼ºç³»ç»Ÿ | æ–°å¢ |
|---------|---------|---------|------|
| **ç”¨æˆ·è®¤è¯** | âœ“ | âœ“ | - |
| **è¯¾ç¨‹ç®¡ç†** | âœ“ | âœ“ | - |
| **ä½œä¸šæäº¤** | âœ“ | âœ“ | - |
| **ä½œä¸šè¯„åˆ†** | âœ“ | âœ“ | - |
| **è¯¾ç¨‹è®¨è®º** | âœ“ | âœ“ | - |
| **å¸–å­å‘å¸ƒ** | âœ— | âœ“ | âœ¨ |
| **çƒ­åº¦è®¡ç®—** | âœ— | âœ“ | âœ¨ |
| **ç‚¹èµç³»ç»Ÿ** | âœ— | âœ“ | âœ¨ |
| **æ”¶è—ç³»ç»Ÿ** | âœ— | âœ“ | âœ¨ |
| **æ ‘å½¢è¯„è®º** | âœ— | âœ“ | âœ¨ |
| **å†…å®¹åˆ†ç±»** | âœ— | âœ“ | âœ¨ |
| **æ™ºèƒ½æœç´¢** | âœ— | âœ“ | âœ¨ |
| **åŒ¿åå‘è¨€** | é™åˆ¶ | âœ“ | âœ¨ |
| **å†…å®¹å‘é‡** | âœ— | âœ“ | âœ¨ |

---

## ğŸ”Œ é›†æˆç‚¹åˆ†æ

### 1. ä¸ç”¨æˆ·ç³»ç»Ÿçš„é›†æˆ

```python
# åŸå§‹
User â†’ StudentInfo, TeacherInfo

# å¢å¼º
User â†’ Post â†’ ä½œè€…èº«ä»½éªŒè¯
User â†’ PostLike â†’ å»é‡ã€ç§¯åˆ†
User â†’ PostComment â†’ è¯„è®ºæƒé™
```

**å½±å“**: æœ€å° - ä»…æ·»åŠ å¤–é”®å…³ç³»

### 2. ä¸è¯¾ç¨‹ç³»ç»Ÿçš„é›†æˆ

```python
# åŸå§‹
Course â†’ CourseFiles, CourseComment

# å¢å¼º
Course â†’ Post â†’ è¯¾ç¨‹å†…è®¨è®º
Course â†’ Post â†’ çƒ­åº¦æ’åºå±•ç¤º
```

**å½±å“**: ä¸­ç­‰ - è¯¾ç¨‹é¡µé¢éœ€æ˜¾ç¤ºè®ºå›å¸–å­

### 3. ä¸æƒé™ç³»ç»Ÿçš„é›†æˆ

```python
# åŸå§‹
type=1 (å­¦ç”Ÿ) â†’ é€‰è¯¾ã€æäº¤ä½œä¸š
type=2 (æ•™å¸ˆ) â†’ å‘å¸ƒè¯¾ç¨‹ã€æ‰¹æ”¹ä½œä¸š
type=3 (ç®¡ç†å‘˜) â†’ ç”¨æˆ·ç®¡ç†

# å¢å¼º
type=1,2 â†’ å¯å‘å¸–ã€è¯„è®ºã€ç‚¹èµ
type=3 â†’ ç®¡ç†æ‰€æœ‰å†…å®¹
```

**å½±å“**: å° - æƒé™ä½“ç³»ä¸å˜ï¼Œä»…æ‰©å±•æƒé™

### 4. ä¸ç§¯åˆ†ç³»ç»Ÿçš„é›†æˆ (é¢„ç•™)

```python
# é¢„ç•™æ¥å£
Post.setBounty(bounty_points)  # è®¾ç½®æ‚¬èµ
PostComment.like()  # è¢«èµ+ç§¯åˆ†

# åç»­å®ç°
IntegralService.awardPoints()
```

**å½±å“**: æ—  - ç°æœ‰ä¸å½±å“ï¼Œé¢„ç•™æ‰©å±•ç‚¹

---

## ğŸ”’ æƒé™ä½“ç³»å˜åŒ–

### åŸå§‹æƒé™çŸ©é˜µ

```
        é€‰è¯¾  å‘ä½œä¸š  æ‰¹æ”¹  ç®¡ç†å‘˜æ“ä½œ
å­¦ç”Ÿ     âœ“     âœ“      -      -
æ•™å¸ˆ     -     -      âœ“      -
ç®¡ç†å‘˜   -     -      -      âœ“
```

### å¢å¼ºæƒé™çŸ©é˜µ

```
        å‘å¸–  ç¼–è¾‘è‡ª  åˆ é™¤ä»»  ç‚¹èµ/è¯„  ç®¡ç†å‘˜æ“ä½œ
å­¦ç”Ÿ     âœ“     âœ“      -      âœ“        -
æ•™å¸ˆ     âœ“     âœ“      -      âœ“        -
ç®¡ç†å‘˜   -     -      âœ“      âœ“        âœ“
```

**å˜åŒ–**: æ‰©å±•å­¦ç”Ÿå’Œæ•™å¸ˆæƒé™ï¼Œå¼ºåŒ–ç®¡ç†å‘˜èŒèƒ½

---

## ğŸ“Š æ•°æ®åº“å¢é•¿ä¼°è®¡

### è¡¨ç»“æ„å˜åŒ–

| è¡¨ | åŸå§‹ | ç°åœ¨ | å¢é•¿ |
|----|------|------|------|
| User | å·²æœ‰ | å·²æœ‰ | - |
| Course | å·²æœ‰ | å·²æœ‰ | - |
| CourseComment | å·²æœ‰ | å·²æœ‰ | - |
| **Post** | æ—  | âœ“ | +100% |
| **PostComment** | æ—  | âœ“ | +100% |
| **PostLike** | æ—  | âœ“ | +100% |
| **PostCollect** | æ—  | âœ“ | +100% |
| **ContentCategory** | æ—  | âœ“ | +100% |

### å­˜å‚¨ä¼°è®¡ (å‡è®¾1000å­¦ç”Ÿ, 100è¯¾ç¨‹, 5000å¸–å­)

```
Post è¡¨: ~5000 Ã— 1KB = 5MB
PostComment è¡¨: ~20000 Ã— 0.5KB = 10MB
PostLike è¡¨: ~50000 Ã— 0.2KB = 10MB
PostCollect è¡¨: ~30000 Ã— 0.2KB = 6MB
ContentCategory: 3 Ã— 0.1KB = 0.3KB

æ€»å¢åŠ : ~31MB
åŸæœ‰ç³»ç»Ÿ: è¯¾ä»¶å’Œä½œä¸šæ–‡ä»¶ä¸»å¯¼ (GBçº§åˆ«)

ç›¸å¯¹å¢é•¿: < 5%
```

---

## ğŸš€ æ€§èƒ½å½±å“åˆ†æ

### åŸå§‹ç³»ç»Ÿç“¶é¢ˆ

1. **è¯¾ç¨‹é¡µé¢åŠ è½½**
   - æŸ¥è¯¢: è¯¾ç¨‹ä¿¡æ¯ + è¯¾ä»¶åˆ—è¡¨ + ä½œä¸šåˆ—è¡¨ + è¯„è®ºåˆ—è¡¨
   - N+1 é—®é¢˜: æ¯ä¸ªé¡¹ç›®éƒ½éœ€æŸ¥è¯¢ä½œè€…ä¿¡æ¯

2. **ç”¨æˆ·ä¸»é¡µ**
   - æŸ¥è¯¢: é€‰è¯¾åˆ—è¡¨ + æœªæäº¤ä½œä¸š + é€šçŸ¥
   - æ— ç¼“å­˜æœºåˆ¶

### å¢å¼ºç³»ç»Ÿæ€§èƒ½è€ƒè™‘

```
æ–°å¢æŸ¥è¯¢:
+ çƒ­é—¨å¸–å­åˆ—è¡¨ (éœ€è¦æ’åºã€åˆ†é¡µ)
+ å¸–å­è¯¦æƒ… + è¯„è®ºæ ‘ (N+1 é£é™©)
+ æœç´¢å¸–å­ (å…¨è¡¨æ‰«æé£é™©)

ä¼˜åŒ–æ–¹æ¡ˆ:
âœ“ æ·»åŠ æ•°æ®åº“ç´¢å¼• (å·²å®ç°)
  â”œâ”€ (course_id, -heatScore)
  â”œâ”€ (-createdAt)
  â””â”€ (post_id, -createdAt)

âœ“ ç¼“å­˜çƒ­åº¦åˆ†æ•° (é¢„ç•™)
  â””â”€ cache.set('post_heat_XXX', score, 3600)

âœ“ ä½¿ç”¨ select_related() (å»ºè®®)
  â””â”€ Post.objects.select_related('author', 'course')
```

### é¢„æœŸæ€§èƒ½å½±å“

| æ“ä½œ | åŸå§‹ | å¢å¼º | æ³¨è®° |
|------|------|------|------|
| è¯¾ç¨‹é¡µåŠ è½½ | 50ms | 55ms | +10% (æ–°å¢å¸–å­) |
| æœç´¢å¸–å­ | N/A | 80ms | æ–°æ“ä½œ |
| æµè§ˆå¸–å­ | N/A | 20ms | æ–°æ“ä½œ |
| å‘å¸– | N/A | 30ms | æ–°æ“ä½œ |

**ç»“è®º**: æ€§èƒ½å½±å“å¯æ§ï¼Œé€šè¿‡ç´¢å¼•å®Œå…¨ä¼˜åŒ–

---

## ğŸ”„ è¿ç§»è·¯å¾„

### å‡çº§æ­¥éª¤

```
å½“å‰ç³»ç»Ÿ (v1.0)
    â†“
æ‰§è¡Œè¿ç§» 0022_post_forum_system
    â†“
åˆå§‹åŒ– ContentCategory
    â†“
æ·»åŠ  URL è·¯ç”±
    â†“
åˆ›å»ºå‰ç«¯æ¨¡æ¿ (å¯é€‰)
    â†“
å¢å¼ºç³»ç»Ÿ (v1.1)
```

### å›æ»šæ–¹æ¡ˆ

```
å¦‚éœ€å›æ»š:
  python manage.py migrate baweb 0021_alter_course_options_course_order

æ³¨æ„:
  âš ï¸ å°†ä¸¢å¤±è®ºå›æ•°æ®
  âœ“ ç°æœ‰æ•°æ®ä¸å—å½±å“
```

---

## ğŸ“š æ¶æ„æ¼”è¿›æˆæœ

### æ–°å¢èƒ½åŠ›

1. **è®¨è®ºåŠŸèƒ½**
   - éç»“æ„åŒ–è®¨è®ºç©ºé—´
   - æ”¯æŒå¤šç§å†…å®¹ç±»å‹
   - çµæ´»çš„çŸ¥è¯†å…±äº«

2. **ç¤¾åŒºäº’åŠ¨**
   - ç‚¹èµã€æ”¶è—æœºåˆ¶
   - æ ‘å½¢è¯„è®ºå¯¹è¯
   - åŒ¿åå‘è¨€ä¿æŠ¤

3. **æ™ºèƒ½æ¨è**
   - çƒ­åº¦ç®—æ³•æ’åº
   - å‘é‡åµŒå…¥é¢„ç•™
   - æœç´¢åŠŸèƒ½é›†æˆ

4. **è¿è¥å·¥å…·**
   - åˆ†ç±»ç®¡ç†
   - å†…å®¹å®¡æ ¸ (é¢„ç•™)
   - æ•°æ®åˆ†æ (é¢„ç•™)

### ç³»ç»Ÿå¥åº·æ€§

```
ä»£ç è´¨é‡: â­â­â­â­â­
  â”œâ”€ ä»£ç è§„èŒƒ: âœ“
  â”œâ”€ æ–‡æ¡£å®Œæ•´: âœ“
  â”œâ”€ é”™è¯¯å¤„ç†: âœ“
  â””â”€ å®‰å…¨é˜²æŠ¤: âœ“

å¯ç»´æŠ¤æ€§: â­â­â­â­â­
  â”œâ”€ æ¨¡å—è§£è€¦: âœ“
  â”œâ”€ æ¥å£æ¸…æ™°: âœ“
  â”œâ”€ æ‰©å±•æ€§: âœ“
  â””â”€ æ–‡æ¡£è¯¦å°½: âœ“

å¯æ‰©å±•æ€§: â­â­â­â­
  â”œâ”€ API é¢„ç•™: âœ“
  â”œâ”€ ç¼“å­˜é¢„ç•™: âœ“
  â”œâ”€ å¼‚æ­¥é¢„ç•™: âœ“
  â””â”€ å‘é‡é¢„ç•™: âœ“
```

---

## ğŸ¯ ä¸‹ä¸€ä»£è§„åˆ’

### Phase 2 (v1.2)

- [ ] AI æ¨èç³»ç»Ÿ
- [ ] å…¨æ–‡æœç´¢ (Elasticsearch)
- [ ] ç§¯åˆ†ç³»ç»Ÿ
- [ ] å†…å®¹å®¡æ ¸

### Phase 3 (v2.0)

- [ ] ç§»åŠ¨ç«¯é€‚é…
- [ ] å®æ—¶é€šçŸ¥
- [ ] æ¨èç®—æ³•ä¼˜åŒ–
- [ ] ç¤¾åŒºè¿è¥åå°

---

**ç³»ç»Ÿæ¼”è¿›å®Œæˆ**
**ç‰ˆæœ¬**: 1.1
**çŠ¶æ€**: å¢å¼ºå®Œæ¯• âœ¨

